angular.module("mdCrudTemplates",[]).run(["$templateCache",function(e){e.put("/views/crud.html",'<div layout-margin layout-padding><div><div class="md-default" layout="row" layout-align="start center"><md-button class="md-raised md-primary" ng-click="table.create($event)" ng-if="!options.noCreate"><translate>Nuevo</translate></md-button><div ng-if="options.templateTools" ng-include="options.templateTools" flex layout="row"></div><div flex></div><div layout="row"><md-button class="md-icon-button md-primary" ng-disabled="true"><md-icon>&#xE8B6;</md-icon></md-button><md-autocomplete md-search-text="searchText" type="search" placeholder="" md-items="item in []"></md-autocomplete></div></div><div ng-if="formType == \'inline\' && rowCreate"><md-card flex layout-fill style="background-color: white"><md-crud-form options="options" ng-model="rowCreate" on-open="onOpen" on-edit="onEdit" on-cancel="onCancel" on-sussces="onSussces" template-url="templateUrl" editable="true"></md-crud-form></md-card><br></div><md-table-container md-whiteframe="1"><table data-md-table md-progress="table.promise"><thead md-head data-md-order="table.order" md-on-reorder="table.refresh" style="background-color: white"><tr md-row><th md-column ng-repeat="field in fields" ng-if="field.columnHiden != true">{{field.label | translate}}</th><th md-column style="min-width:132px;width:132px" ng-if="!options.noDelete"></th><th md-column style="min-width:60px;width:60px" ng-if="options.noDelete"></th></tr></thead><tbody md-body><tr md-row md-select="row" ng-repeat-start="row in table.rows | filter:searchText | limitTo: table.limit: (table.page - 1) * table.limit" ng-mouseover="row.mouserover=true" ng-mouseleave="row.mouserover=false" ng-class="{ \'md-selected\': row.mouserover || rowSelected == row }" ng-click="table.detail(row, $event)"><td md-cell ng-repeat="field in fields" ng-if="field.columnHiden != true"><div ng-switch="ef(field.type, row)" ng-if="!field.columnTemplate"><span ng-switch-when="boolean"><md-switch ng-model="row[field.name]" ng-disabled="true" aria-label="{{field.label | translate}}"></md-switch></span><image ng-switch-when="image" ng-src="{{row[field.name]}}" style="max-height:90px"></image><span ng-switch-when="date">{{ row[field.name] | date:\'shortDate\' }}</span> <span ng-switch-default>{{row[field.name] | translate}}</span></div><span ng-if="field.columnTemplate" ng-bind-html="stringToHtml(field.columnTemplate, row)"></span></td><td md-cell><md-button class="md-icon-button md-accent" ng-show="row.mouserover || rowSelected == row " ng-click="table.edit(row, $event)"><md-icon>&#xE3C9;</md-icon></md-button><md-button class="md-icon-button md-accent" ng-show="row.mouserover || rowSelected == row " ng-click="table.delete(row[options.id], $event)" ng-if="!options.noDelete"><md-icon>&#xE92B;</md-icon></md-button></td></tr><tr ng-repeat-end ng-if="rowSelected == row"><td colspan="{{fields.length + 1}}"><md-card layout-fill style="background-color: white"><md-crud-form ng-if="formEditable" options="options" ng-model="row" on-open="onOpen" on-edit="onEdit" on-cancel="onCancel" on-sussces="onSussces" template-url="templateUrl" editable="formEditable"></md-crud-form><md-crud-form ng-if="!formEditable" options="options" ng-model="row" on-open="onOpen" on-edit="onEdit" on-cancel="onCancel" on-sussces="onSussces" template-url="templateUrl" editable="formEditable"></md-crud-form></md-card></td></tr></tbody></table><md-table-pagination md-limit="table.limit" md-limit-options="[10, 20, 30]" md-page="table.page" md-total="{{(table.rows | filter:searchText).length}}" md-page-select md-label="{{table.labels}}" style="background-color: white"></md-table-pagination></md-table-container></div></div>'),e.put("/views/crudForm.html",'<div layout-padding><form name="formCrud" ng-submit="formCrud.$valid && save()" layout="row" layout-wrap><div ng-repeat="field in fields" flex="{{field.flex || \'grow\'}}" ng-if="(formType==\'create\' && !field.createHiden) || (formType==\'edit\' && !field.editHiden) || (formType==\'detail\' && !field.detailHiden)"><div ng-if="field.templateUrl" ng-include="field.templateUrl"></div><md-input-container class="md-block" flex ng-if="(ef(field.type, item) == \'text\' || !ef(field.type, item)) && field.name"><label>{{field.label | translate}}</label><input ng-model="item[field.name]" name="{{field.name}}" ng-required="field.required" ng-disabled="field.readonly || readonly" ng-minlength="field.minlength" ng-maxlength="field.maxlength" ng-pattern="field.pattern"><div ng-messages="formCrud[field.name].$error"><div ng-message="required"><translate>Este campo es requerido.</translate></div><div ng-message="minlength"><translate>Mínimo de caracteres</translate>({{field.minlength}}).</div><div ng-message="maxlength"><translate>Máximo de caracteres</translate>({{field.maxlength}}).</div><div ng-message="pattern">{{field.messagePattern || (\'El valor ingresado no tiene el formato correcto\' | translate)}}</div></div></md-input-container><md-input-container class="md-block" flex ng-if="ef(field.type, item) == \'textarea\'"><label>{{field.label | translate}}</label><textarea ng-model="item[field.name]" name="{{field.name}}" ng-required="field.required" ng-disabled="field.readonly || readonly" ng-minlength="field.minlength" ng-maxlength="field.maxlength" rows="{{ field.rows || 3 }}" md-select-on-focus></textarea><div ng-messages="formCrud[field.name].$error"><div ng-message="required"><translate>Este campo es requerido.</translate></div><div ng-message="minlength"><translate>Mínimo de caracteres</translate>({{field.minlength}}).</div><div ng-message="maxlength"><translate>Máximo de caracteres</translate>({{field.maxlength}}).</div><div ng-message="pattern">{{field.messagePattern || (\'El valor ingresado no tiene el formato correcto\' | translate)}}</div></div></md-input-container><md-input-container class="md-block" flex ng-if="ef(field.type, item) == \'email\'"><label>{{field.label | translate}}</label><input ng-model="item[field.name]" name="{{field.name}}" ng-required="field.required" type="email" ng-disabled="field.readonly || readonly" ng-minlength="field.minlength" ng-maxlength="field.maxlength" ng-pattern="field.pattern"><div ng-messages="formCrud[field.name].$error"><div ng-message="required"><translate>Este campo es requerido.</translate></div><div ng-message="minlength"><translate>Mínimo de caracteres</translate>({{field.minlength}}).</div><div ng-message="maxlength"><translate>Máximo de caracteres</translate>({{field.maxlength}}).</div><div ng-message="pattern">{{field.messagePattern || (\'El valor ingresado no tiene el formato correcto\' | translate)}}</div></div></md-input-container><md-input-container class="md-block" flex ng-if="ef(field.type, item) == \'integer\'"><label>{{field.label | translate}}</label><input type="number" ng-model="item[field.name]" name="{{field.name}}" ng-required="field.required" ng-disabled="field.readonly || readonly" ng-min="field.min" ng-max="field.max" step="{{field.step || 1}}"><div ng-messages="formCrud[field.name].$error"><div ng-message="required"><translate>Este campo es requerido.</translate></div><div ng-message="min"><translate>Valor mínimo</translate>({{field.min}}).</div><div ng-message="max"><translate>Valor máximo</translate>({{field.max}}).</div></div></md-input-container><md-input-container class="md-block" flex ng-if="ef(field.type, item) == \'decimal\'"><label>{{field.label | translate}}</label><input type="number" ng-model="item[field.name]" name="{{field.name}}" ng-required="field.required" ng-disabled="field.readonly || readonly" ng-min="field.min" ng-max="field.max" step="{{field.step || \'any\'}}"><div ng-messages="formCrud[field.name].$error"><div ng-message="required"><translate>Este campo es requerido.</translate></div><div ng-message="min"><translate>Valor mínimo</translate>({{field.min}}).</div><div ng-message="max"><translate>Valor máximo</translate>({{field.max}}).</div></div></md-input-container><div class="md-block" flex ng-if="ef(field.type, item) == \'image\'"><lf-ng-md-file-input name="{{field.name | translate}}" lf-files="files[field.name]" lf-mimetype="image/*" lf-placeholder="{{field.label}}" lf-browse-label="Abrir" lf-remove-label="Eliminar"></lf-ng-md-file-input><div ng-messages="formCrud[field.name].$error" md-colors="{color: \'warn\'}"><div ng-message="mimetype"><translate>El archivo no tiene el formato correcto.</translate></div></div><br></div><div class="md-block" flex ng-if="ef(field.type, item) == \'map\'"><ng-map zoom="{{field.zoom || 11}}" center="{{item[field.lat]}},{{item[field.lng]}}"><marker position="{{item[field.lat]}},{{item[field.lng]}}" title="drag me" draggable="true" on-dragend="onMarkerDrag()" data="{{field}}"></marker></ng-map></div><md-input-container class="md-block" flex ng-if="ef(field.type, item) == \'boolean\'"><md-switch ng-model="item[field.name]" ng-disabled="field.readonly || readonly" aria-label="field.label">{{field.label | translate}}</md-switch></md-input-container><md-input-container class="md-block" flex ng-if="ef(field.type, item) == \'select\'"><label>{{field.label | translate}}</label><md-select ng-model="item[field.name]" ng-if="field.multiple" multiple="multiple" ng-disabled="field.readonly || readonly" ng-required="field.required"><md-option ng-value="mdSelectItem[field.value || \'value\']" ng-repeat="mdSelectItem in ef(field.data, item)">{{mdSelectItem[field.text || \'text\']}}</md-option></md-select><md-select ng-model="item[field.name]" ng-if="!field.multiple" ng-disabled="field.readonly || readonly" ng-required="field.required"><md-option ng-if="!field.required"></md-option><md-option ng-value="mdSelectItem[field.value || \'value\']" ng-repeat="mdSelectItem in ef(field.data, item)">{{mdSelectItem[field.text || \'text\']}}</md-option></md-select></md-input-container><md-input-container class="md-block" flex ng-if="ef(field.type, item) == \'date\'"><label>{{field.label | translate}}</label><md-datepicker ng-model="item[field.name]" md-min-date="field.minDate" md-max-date="field.maxDate" ng-disabled="field.readonly || readonly" ng-required="field.required"></md-datepicker><div ng-messages="formCrud[field.name].$error"><div ng-message="valid">The entered value is not a date!</div><div ng-message="required">This date is required!</div><div ng-message="mindate">Date is too early!</div><div ng-message="maxdate">Date is too late!</div></div></md-input-container></div><div ng-repeat="message in errors" md-colors="{color:\'warn\'}" flex="grow">{{message}}</div><div layout="row" layout-align="center center" flex="grow"><md-button class="md-raised" ng-click="cancel()"><translate>Cancel</translate></md-button><div flex="5"></div><md-button class="md-raised md-primary" type="submit" ng-disabled="readonly"><translate>Save</translate></md-button></div></form></div>'),e.put("/views/crudFormDialog.html",'<md-dialog aria-label="Editar" flex="50"><md-toolbar><div class="md-toolbar-tools"><h2>{{formTitle | translate}}</h2><span flex></span><md-button class="md-icon-button" ng-click="cancelDialog()"><md-icon aria-label="Cerrar">close</md-icon></md-button></div></md-toolbar><md-dialog-content><md-crud-form options="options" ng-model="item" on-open="onOpen" on-edit="onEdit" on-cancel="onCancelDialog" on-sussces="onSusscesDialog" template-url="templateUrl" editable="formEditable"></md-crud-form></md-dialog-content></md-dialog>')}]),function(){"use strict";angular.module("mdCrudModule",["mdCrudTemplates"])}(),function(){"use strict";function e(e,t,n,i,l){function o(o,a,r){var d=o.options;o.formType=o.formType||d.formType||e.options.formType,o.fields=d.fields,o.rowSelected=null;var m={};o.rowCreate=null,o.ef=t.evalFunction,o.stringToHtml=function(e,t){return l(e)(t)},o.table={rows:[],refresh:function(t){t&&(m=t),o.table.promise=e.get({entity:d.entity,params:m,rootApi:d.rootApi}).then(function(e){o.table.rows=e})},create:function(e){e.stopPropagation(),o.rowSelected=null,o.rowCreate={},"window"==o.formType&&s({},!0,e).then(function(e){})},edit:function(e,t){t.stopPropagation(),"inline"==o.formType&&o.selectRow(e,!0),"window"==o.formType&&s(e,!0,t).then(function(e){})},detail:function(e,t){t.stopPropagation(),"inline"==o.formType&&(o.rowSelected==e?o.rowSelected=null:o.selectRow(e,!1)),"window"==o.formType&&s(e,!1,t).then(function(e){})},delete:function(n,l){o.rowSelected=null,l.stopPropagation();var a=this,r=this.rows.findIndex(function(e){return e[d.id]==n});t.showConfirm(i.getString("Eliminar"),i.getString("¿Está seguro de eliminar el registro?")).then(function(){e.delete({entity:d.entity,id:n,rootApi:d.rootApi}).then(function(e){a.rows.splice(r,1)},function(e){e||(e=i.getString("No se pudo eliminar el registro, contacte con el administrador del sistema.")),t.showAlert(i.getString("Error al intentar eliminar el registro."),e)})})},promise:null,order:"",limit:10,page:1,rowSelection:!1,selected:[]},d.refresh=function(e){o.table.refresh(e)};var s=function(e,t,i){return o.formEditable=t,n.show({controller:["$scope","$mdDialog","mdCrudService","item","options",f],templateUrl:"/views/crudFormDialog.html",clickOutsideToClose:!0,fullscreen:!0,scope:o,preserveScope:!0,controllerAs:"vm",locals:{item:e,options:d},targetEvent:i,parent:a})},c=function(){o.table.labels={page:i.getString("Página:"),rowsPerPage:i.getString("Filas por página:"),of:i.getString("de")}};c(),o.$on("gettextLanguageChanged",function(){c()}),o.templateUrl=(d.form||{}).templateUrl,o.onOpen=function(e){(d.form||{}).onOpen&&d.form.onOpen(e)},o.onEdit=function(e){(d.form||{}).onEdit&&d.form.onEdit(e)},o.onCancel=function(e){(d.form||{}).onCancel&&d.form.onCancel(e),o.rowSelected=null,o.rowCreate=null},o.onSussces=function(e,t){(d.form||{}).onSussces&&d.form.onSussces(e,t),"create"==t&&o.table.rows.unshift(e),o.rowSelected=null,o.rowCreate=null},o.selectRow=function(e,t){o.rowSelected=e,o.formEditable=t};var f=function(e,t,n,i,l){e.formTitle=i[l.id]?e.formEditable?"Editar":"Detalle":"Nuevo",e.item=i,e.onCancelDialog=function(e){(l.form||{}).onCancel&&l.form.onCancel(e),t.cancel()},e.onSusscesDialog=function(e,n){(l.form||{}).onSussces&&l.form.onSussces(e,n),t.hide(e)},e.cancelDialog=function(){e.onCancelDialog(i)}}}var a={link:o,restrict:"EA",scope:{options:"="},templateUrl:"/views/crud.html"};return a}angular.module("mdCrudModule").directive("mdCrud",e),e.$inject=["mdCrudService","mdCrudToolsService","$mdDialog","gettextCatalog","$interpolate"]}(),function(){"use strict";function e(e,t){function n(n,i,l){var o=n.options;n.fields=o.fields,n.readonly=0==n.editable,n.ef=t.evalFunction;var a=n.ngModel[o.id];n.formTitle=a?n.editable?"Editar":"Detalle":"Nuevo",n.formType=a?n.editable?"edit":"detail":"create",n.fields=o.fields,n.item={},n.getContentUrl=function(e,t){return n.templateUrl||"/views/crudForm.html"},n.onOpen&&n.onOpen(n.item),a&&e.getById({entity:o.entity,id:a,rootApi:o.rootApi}).then(function(e){n.item=e,n.onEdit&&n.onEdit(n.item)},function(e){n.onError&&n.onError(e)}),n.save=function(){var t;t=a?e.patch({entity:o.entity,id:n.item[o.id],data:n.item,rootApi:o.rootApi}):e.post({entity:o.entity,data:n.item,rootApi:o.rootApi}),t.then(function(e){angular.copy(e,n.ngModel),n.onSussces&&n.onSussces(e,n.formType)},function(e){e.details?n.errors=e.details:n.errors=[e.error],n.onError&&n.onError(e)})},n.cancel=function(){n.onCancel&&n.onCancel(n.item)},n.onMarkerDrag=function(e){n.item[this.data.lat]=e.latLng.lat(),n.item[this.data.lng]=e.latLng.lng()}}var i={link:n,restrict:"EA",scope:{options:"=",ngModel:"=",onOpen:"=",onEdit:"=",onCancel:"=",onSussces:"=",templateUrl:"<?",editable:"<?"},template:'<div ng-include="getContentUrl()"></div>'};return i}angular.module("mdCrudModule").directive("mdCrudForm",e),e.$inject=["mdCrudService","mdCrudToolsService"]}(),function(){"use strict";function e(e,t,n,i){var l={rootApi:"/api",methodGet:"GET",methodPost:"POST",methodPatch:"PATCH",methodDelete:"DELETE",urlGet:"{{rootApi}}/{{entity}}",urlGetById:"{{rootApi}}/{{entity}}/{{id}}",urlPost:"{{rootApi}}/{{entity}}",urlPatch:"{{rootApi}}/{{entity}}/{{id}}",urlDelete:"{{rootApi}}/{{entity}}/{{id}}",functionHttp:function(i){return e(function(e,o){n({url:t(i.url)(i),method:i.method,params:i.params,data:i.data}).then(function(t){l.functionData(t,e,o)},function(e){o(e.data)})})},functionData:function(e,t,n){t(e.data)},formType:"inline"};return{options:l,setDefaultOptions:function(e){angular.extend(l,i.removeNull(e))},get:function(e){var t={url:l.urlGet,method:l.methodGet,rootApi:l.rootApi};return angular.extend(t,i.removeNull(e)),l.functionHttp(t)},getById:function(e){var t={url:l.urlGetById,method:l.methodGet,rootApi:l.rootApi};return angular.extend(t,i.removeNull(e)),l.functionHttp(t)},post:function(e){var t={url:l.urlPost,method:l.methodPost,rootApi:l.rootApi};return angular.extend(t,i.removeNull(e)),l.functionHttp(t)},patch:function(e){var t={url:l.urlPatch,method:l.methodPatch,rootApi:l.rootApi};return angular.extend(t,i.removeNull(e)),l.functionHttp(t)},delete:function(e){var t={url:l.urlDelete,method:l.methodDelete,rootApi:l.rootApi};return angular.extend(t,i.removeNull(e)),l.functionHttp(t)}}}angular.module("mdCrudModule").service("mdCrudService",["$q","$interpolate","$http","mdCrudToolsService",e])}(),function(){"use strict";function e(e){return{showConfirm:function(t,n,i,l){i=i||"Si",l=l||"No";var o=e.confirm().title(t).ariaLabel(t).textContent(n).ok(i).cancel(l);return e.show(o)},showAlert:function(t,n){e.show(e.alert().clickOutsideToClose(!0).title(t).ariaLabel(t).textContent(n).ok("Continuar"))},getBase64:function(e){return $q(function(t,n){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){t(i.result)},i.onerror=function(e){n(e)}})},removeNullRecursive:function(e){var t=function(e,n){var i=n[e];if(null===i||void 0===i)delete n[e];else if("object"==typeof i)for(var l in i)t(l,i)};for(var n in e)t(n,e);return e},removeNull:function(e){for(var t in e){var n=e[t];null!==n&&void 0!==n||delete e[t]}return e},evalFunction:function(e,t){return angular.isFunction(e)?e(t):e}}}angular.module("mdCrudModule").service("mdCrudToolsService",["$mdDialog",e])}();